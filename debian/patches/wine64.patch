Description: Workaround case where wine and related binaries are in /usr/bin, but wine64 is only
  in Wine's bindir.
Author: Jens Reyer <jre.winesim@gmail.com>
Forwarded: https://github.com/Winetricks/winetricks/pull/2035
Last-Update: 2023-02-26

--- a/src/winetricks
+++ b/src/winetricks
@@ -4922,10 +4922,17 @@ winetricks_set_wineprefix()
         elif command -v "${WINE}64" >/dev/null 2>&1; then
             WINE64="${WINE}64"
         else
-            # Handle case where wine binaries (or binary wrappers) have a suffix
-            WINE64="$(dirname "${WINE}")/"
-            [ "${WINE64}" = "./" ] && WINE64=""
-            WINE64="${WINE64}$(basename "${WINE}" | sed 's/^wine/wine64/')"
+            WINE_BINDIR="$(dirname "$(readlink -f /usr/bin/wineboot 2>/dev/null)" 2>/dev/null)"
+            if [ -x "${WINE_BINDIR}/wine64" ]; then
+                # Workaround case where wine and related binaries are in /usr/bin, but wine64 is only
+                # in Wine's bindir
+                WINE64="${WINE_BINDIR}/wine64"
+            else
+                # Handle case where wine binaries (or binary wrappers) have a suffix
+                WINE64="$(dirname "${WINE}")/"
+                [ "${WINE64}" = "./" ] && WINE64=""
+                WINE64="${WINE64}$(basename "${WINE}" | sed 's/^wine/wine64/')"
+            fi
         fi
         WINE_ARCH="${WINE64}"
         WINE_MULTI="${WINE}"
